C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\lotteryMan.src, Line 16
program BrainNerve( params )
use cfgfile;
0: get arg 'params'
var npc		:= params[1];
1: decl local #1
2: local #0
3: 1L
4: [] 1
5: :=
6: #
var event	:= params[3];
7: decl local #2
8: local #0
9: 3L
10: [] 1
11: :=
12: #
params := 0; // Not needed anymore.
13: 0L
14: local0 := 
while( npc )
15: local #1
16: if false goto 39
if( event )
17: local #2
18: if false goto 32
case( event.type )
19: local #2
20: get member 'type'
21: casejmp
	1024: @22
	default: @29
ItemGivenEvent( npc, event );
22: local #1
23: local #2
24: makelocal
25: jmp userfunc @41
26: #
break;
27: goto28
28: goto30
break;
29: goto30
event := 0;
30: 0L
31: local2 := 
SleepMS(5);
32: 5L
33: Func(3,2): Sleepms
34: #
event := Wait_For_Event(1);
35: 1L
36: Func(3,6): Wait_For_Event
37: local2 := 
38: goto15
39: leave block(3)
40: progend
C:\ZH099\pkg\systems\brainAI\scripts\itemGiven\lotteryMan.src, Line 43
function ItemGivenEvent( npc, byref event )
41: pop param byref 'event'
42: pop param 'npc'
var item := event.item;
43: decl local #2
44: local #0
45: get member 'item'
46: :=
47: #
var source := event.source;
48: decl local #3
49: local #0
50: get member 'source'
51: :=
52: #
ReleaseItem( item );
53: local #2
54: Func(2,5): ReleaseItem
55: #
if( source.hidden || source.IsA( POLCLASS_NPC ))
56: local #3
57: get member id 'hidden' (32)
58: local #3
59: 4L
60: Call Method id isa (#0, 1 params)
61: ||
62: if false goto 65
return 1;
63: 1L
64: return
var start := start_script( ":lottery:lotteryMan/collectTicket", {npc, source, i
65: decl local #4
66: ":lottery:lotteryMan/collectTicket"
67: array
68: local #1
69: init{}
70: local #3
71: init{}
72: local #2
73: init{}
74: Func(3,3): Start_Script
75: :=
76: #
if( start.errortext )
77: local #4
78: get member 'errortext'
79: if false goto 89
SendSysMessage( source, "Error cannot start script <:lottery:lotteryMan/collect
80: local #3
81: "Error cannot start script <:lottery:lotteryMan/collectTicket> -->"
82: local #4
83: get member 'errortext'
84: +
85: 3L
86: 1000L
87: Func(2,6): SendSysMessage
88: #
return 1;
89: 1L
90: return
