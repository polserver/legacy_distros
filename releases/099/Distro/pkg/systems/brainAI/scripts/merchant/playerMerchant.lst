C:\ZH099\pkg\systems\brainAI\scripts\merchant\playerMerchant.src, Line 13
program BrainNerve( params )
include ":brainAI:eventid";
0: get arg 'params'
var npc		:= params[1];
1: decl local #1
2: local #0
3: 1L
4: [] 1
5: :=
6: #
var event	:= params[3];
7: decl local #2
8: local #0
9: 3L
10: [] 1
11: :=
12: #
params := 0; // Not needed anymore.
13: 0L
14: local0 := 
while( npc )
15: local #1
16: if false goto 39
if( event )
17: local #2
18: if false goto 32
case( event.type )
19: local #2
20: get member 'type'
21: casejmp
	512: @22
	default: @29
SoldEvent( npc, event );
22: local #1
23: local #2
24: makelocal
25: jmp userfunc @43
26: #
break;
27: goto28
28: goto30
break;
29: goto30
event := 0;
30: 0L
31: local2 := 
SleepMS(5);
32: 5L
33: Func(3,2): Sleepms
34: #
event := Wait_For_Event(1);
35: 1L
36: Func(3,6): Wait_For_Event
37: local2 := 
38: goto15
return 1;
39: 1L
40: progend
41: leave block(3)
42: progend
C:\ZH099\pkg\systems\brainAI\scripts\merchant\playerMerchant.src, Line 42
function SoldEvent( npc, byref event )
43: pop param byref 'event'
44: pop param 'npc'
PrintTextAbovePrivate( npc, "The total of thy purchase is " + event.amount, eve
45: local #1
46: "The total of thy purchase is "
47: local #0
48: get member id 'amount' (13)
49: +
50: local #0
51: get member 'source'
52: 3L
53: local #1
54: get member id 'speech_color' (66)
55: 0L
56: Func(2,5): PrintTextAbovePrivate
57: #
var my_gold := CInt( GetObjProperty( npc, "MyGold" ));
58: decl local #2
59: local #1
60: "MyGold"
61: Func(2,2): GetObjProperty
62: Func(0,2): CInt
63: :=
64: #
if( !my_gold )
65: local #2
66: if true goto 69
my_gold := 0;
67: 0L
68: local2 := 
SetObjProperty( npc, "MyGold", my_gold + event.amount );
69: local #1
70: "MyGold"
71: local #2
72: local #0
73: get member id 'amount' (13)
74: +
75: Func(2,1): SetObjProperty
76: #
var owner := SystemFindObjectBySerial( CInt( GetObjProperty( npc, "Owner" )));
77: decl local #3
78: local #1
79: "Owner"
80: Func(2,2): GetObjProperty
81: Func(0,2): CInt
82: 0L
83: Func(2,6): SystemFindObjectBySerial
84: :=
85: #
if( owner )
86: local #3
87: if false goto 103
SendSysMessage( owner, event.source.name+" bought for "+event.amount+" gold coi
88: local #3
89: local #0
90: get member 'source'
91: get member id 'name' (3)
92: " bought for "
93: +
94: local #0
95: get member id 'amount' (13)
96: +
97: " gold coins worth of items."
98: +
99: 3L
100: 1000L
101: Func(2,7): SendSysMessage
102: #
return 1;
103: 1L
104: return
